\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bussproofs}
\usepackage{mathtools}
\usepackage{verbatim}
\usepackage{dsfont}
\usepackage{mathabx}
\usepackage[all, 2cell]{xy}
\usepackage[all]{xy}
\usepackage{wasysym}
\usepackage{rotating}
\usepackage{geometry}
\usepackage{trfsigns}
\usepackage{cmll}
\usepackage{authblk}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{lipsum}
\usepackage{extpfeil}
\usepackage{soul}
\usepackage{graphicx}

\newcommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}

\theoremstyle{defin}
\newtheorem{defin}{Definition}

\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}

\theoremstyle{prop}
\newtheorem{prop}{Proposition}

\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}

\theoremstyle{fact}
\newtheorem{fact}{Fact}

\theoremstyle{ex}
\newtheorem{ex}{Example}


\theoremstyle{col}
\newtheorem{col}{Corollary}

\author{Daniel Rogozin}
\date{}
\title{Model-theoretic aspects of relativised cylindric set algebras}

\begin{document}

\maketitle

\section{Intro}
...
It is known that the equational theory of ${\bf RCA}_{\omega}$ for $\alpha \leq \omega$ is decidable \cite{nemeti1996fine}.
...

\section{The problems themselves}

\begin{enumerate}
\item Suppose $\mathcal{C} \in {\bf RCA}_{\omega}$, whether $\mathcal{C}^{+}$ has a complete, $\omega$-dimensional representation? \cite{hirsch2002relation}
\item Is the class ${\bf IG}_{\omega}$ (the isomorphism-closure of the $\omega$-dimensional cylindric relativised set algebras in which the unit is closed under substitutions and permutations) a variety, or even
a pseudo-elementary class? Is it closed under ultraproducts? \cite{hirsch2002relation}
\end{enumerate}

\section{Boolean algebras with operators and cylindric algebras}

\begin{defin}

$ $

  \begin{enumerate}
    \item Let $\mathcal{B} = \langle B, +, -, 0, 1 \rangle$ be a Boolean algebra. An operator is an $n$-ary function $\Omega : B^n \to B$ satisfying the following conditions:
    \begin{itemize}
      \item Normality: for all $b_0, \dots, b_{n - 1} \in B$, if $b_1 = 0$ for some $i < n$, then

\begin{center}
      $\Omega(b_0, \dots, b_{i - 1}, 0, b_{i+1}, \dots, b_{n - 1}) = 0$
\end{center}
      \item Additivity: for all $b_0, \dots, b_{n - 1}, b, b' \in B$ we have
      \begin{center}
        $\Omega(b_0, \dots, b_{i - 1}, (b + b'), b_{i+1}, \dots, b_{n - 1}) = \Omega(b_0, \dots, b_{i - 1}, b, b_{i+1}, \dots, b_{n - 1}) + \Omega(b_0, \dots, b_{i - 1}, b', b_{i+1}, \dots, b_{n - 1})$
      \end{center}
    \end{itemize}
    \item Let $I$ be an index set, a Boolean algebra with operators (BAO) is an algebra $\langle B, +, -, 0, 1, \{ \Omega_{i} \}_{i \in I} \rangle$ such that $\langle B, +, -, 0, 1 \rangle$ is a Boolean algebra and for each $i \in I$ $\Omega_{i}$ is an operator.
  \end{enumerate}
\end{defin}

\begin{defin} Let $\mathcal{B} = \langle B, +, -, 0, 1, \{ \Omega_{i} \}_{i \in I} \rangle$ be a BAO, then

  \begin{enumerate}
    \item An opetator $\Omega$ is completely additive, if for each $b_0, \dots, b_{n - 1} \in B$ and $X \subseteq B$, one has

    \begin{center}
      $\Omega(b_0, \dots, b_{i-1}, \sum X, b_{i+1}, \dots, b_{n - 1}) = \sum \limits_{x \in X} \Omega(b_0, \dots, b_{i-1}, x, b_{i+1}, \dots, b_{n - 1})$
    \end{center}
    \item $\mathcal{B}$ is completely additive, if for each $i \in I$ $\Omega_{i}$ is additive,
    \item A class $\mathcal{K}$ of BAOs is completely additive, if every $\mathcal{B} \in \mathcal{K}$ is completely additive.
  \end{enumerate}
\end{defin}

\subsection{Atom structures and canonical extensions}

\begin{defin}  Let $I$ be an index set and $\{ \Omega_i\}_{i \in I}$ a set of function symbols
\begin{enumerate}
  \item An atom structure is a relational structrure
  $\mathcal{F} = \langle W, \{ R_{i} \}_{i \in I} \rangle$
  such that $R_{i}$ is a $n+1$-ary relation symbol, if $\Omega_{i \in I}$ is an $n$-ary function symbol,
  \item Let $\mathcal{B}$ be an atomic BAO of the signature $I$,
the atom structure of $\mathcal{B}$, written as ${\bf At} \mathcal{B}$, is an atom structure $\langle \operatorname{At}(\mathcal{B}), \{ R_{i}\}_{i \in I} \rangle$ such that for each
$a, b_0, \dots, b_{n + 1} \in \operatorname{At}(\mathcal{B})$ and for each $i \in I$
\begin{center}
  ${\bf At} \mathcal{B} \models R_{i}(a,  b_0, \dots, b_{n + 1})$ iff $\mathcal{B} \models a \leq \Omega_{i}(b_0, \dots, b_{n + 1})$
\end{center}
\item Let $\mathcal{F} = \langle W, \{ R_{i} \}_{i \in I} \rangle$ be an atom structure, the complex algebra of $\mathcal{F}$, written as $\bf{Cm} \mathcal{F}$, is a BAO
$\langle \mathcal{P}(W), \cup, -, \emptyset, W, \{\Omega_{R_{i}}\}_{i \in I} \rangle$ such that
for all $X_0, \dots, X_{n - 1} \subseteq W$ and for each $i \in I$
\begin{center}
  $\Omega_{R_{i}}(X_0, \dots, X_{n - 1}) = \{ a \in W \: | \: \exists b_0 \in X_0 \dots \exists b_{n -1} \in X_{n - 1} \: \mathcal{F} \models R_{i}(a, b_0, \dots, b_{n - 1})\}$
\end{center}
\end{enumerate}
\end{defin}

The following duality is due to Thomason \cite{thomason1975categories}.

\begin{fact}
  $ $

  \begin{enumerate}
    \item Let $\mathcal{B}$ be a complete atomic BAO, then $\mathcal{B} \cong \bf{Cm} (\bf{At}(\mathcal{B}))$,
    \item Let $\mathcal{F}$ be an atom structure, then $\mathcal{F} \cong {\bf At}({\bf Cm}(\mathcal{B}))$.
  \end{enumerate}
\end{fact}

Let $A$ be a non-empty subset of a Boolean algebra $\mathcal{B}$, $A$ is a \emph{filter}, if $A$ is closed under finite infima and upwardly closed. $A$ is an ultrafilter, if it has no non-trivial extensions. That is, if $A \subseteq A'$, then $A' = \mathcal{B}$.

\begin{defin}
  Let $\mathcal{B} = \langle B, +, -, 0, 1, \{ \Omega_i \}_{i \in I} \rangle$ be a BAO and ${\bf Uf}(\mathcal{B})$ the set of its ultrafilters. The ultrafilter frame of $\mathcal{B}$ (or canonical frame) is a relational structure $\mathcal{F}_{\mathcal{B}} = \langle {\bf Uf}(\mathcal{B}), R_{\Omega_i} \rangle$ such that for each ultrafilters $\beta_0, \dots, \beta_{n - 1}, \gamma$ one has
  \begin{center}
    ${\bf Uf}(\mathcal{B}) \models R_{\Omega_i}(\beta_0, \dots, \beta_{n - 1}, \gamma)$ iff $\{ \Omega(b_0, \dots, b_{n - 1}) \: | \: b_0 \in \beta_0, \dots, b_{n - 1} \in \beta_{n - 1}\} \subseteq \gamma$.
  \end{center}
\end{defin}

\begin{defin} Let $\mathcal{B}$ be a BAO, then

  \begin{enumerate}
    \item The canonical extension of $\mathcal{B}$ is a complex algebra of the canonical frame ${\bf Cm}(\mathcal{F}_{\mathcal{B}})$ denoted as $\mathcal{B}^{+}$,
    \item The class of BAOs is canonical, if it is closed under canonical extensions.
  \end{enumerate}
\end{defin}

\begin{theorem} Let $\mathcal{A}$, $\mathcal{B}$ be BAOs,

\begin{enumerate}
  \item There exists $\iota : \mathcal{A} \hookrightarrow \mathcal{A}^{+}$ such that
  $\iota : a \mapsto \{ \gamma \in {\bf Uf}(\mathcal{A}) \: | \: a \in \gamma \}$.
  \item If $i : \mathcal{A} \hookrightarrow \mathcal{B}$, then this embedding might be extented to the embedding
  $i^{+} : \mathcal{A}^{+} \hookrightarrow \mathcal{B}^{+}$
\end{enumerate}
\end{theorem}

\begin{fact}
\end{fact}

\subsection{(Representable) cylindric algebras and cylindric set algebras}

Let $\alpha$ be an ordinal. Let $\prescript{\alpha}{}U$ be the set of all functions mapping $\alpha$ to a non-empty set $U$. We denote $x(i) = x_i$ for
$x \in \prescript{\alpha}{}U$ and $i < \alpha$.

\begin{defin}
$ $

  \begin{enumerate}
    \item A subset of $\prescript{\alpha}{}U$ is an $\alpha$-ry relation on $U$. For $i, j < \alpha$, the $i,j$-diagonal $D_{ij}$ is the set of all
    elements of $U$ such that $y_i = y_j$.

    If $i < \alpha$ and $X$ is an $\alpha$-ry relation on $U$, then
    the $i$-th cylindrification $C_i X$ is the set of all elements of $U$ that agree with some element of $X$ on each coordinate except the
    $i$-th one. To be more precise,
    $C_i X = \{ y \in \prescript{\alpha}{}U \: | \: \exists x \in X \forall i < \alpha \: (i \neq j \Rightarrow y_j = x_j)\}$.
    \item A cylindic set algebra of dimension $\alpha$ is an algebra consisting of a set $S$ of $\alpha$-ry relation on some base set $U$
    with the constants and operations $0 = \emptyset$, $1 = \prescript{\alpha}{}U$, $\cap$, $-$, the diagonal elements $\{ D_{ij} \}_{i, j < \alpha}$,
    the cylindrifications $\{ C \}_{i < \alpha}$.

    A generalised cylindric set algebra of dimension $\alpha$ is a subdirect of
    cylindric algebras that have dimension $\alpha$
    \item A cylindric algebra of dimension $\alpha$ is an algebra $\mathcal{C} = \langle \mathcal{B}, \{ c_i \}_{i < \alpha}, \{ d_{ij} \}_{i, j < \alpha} \rangle$ such that
    \begin{itemize}
      \item $\mathcal{B}$ is a Boolean algebra, for each $i, j < \alpha$ $c_i$ is an operator and $d_{ij} \in \mathcal{B}$
      \item For each $i < \alpha$, $a \leq c_i a$, $c_i (a \land c_i b) = c_i a \land c_i b$ and $d_{ii} = 1$
      \item For every $i, j < \alpha$, $c_i c_j a = c_j c_i a$
      \item If $k \neq i, j < \alpha$, then $d_{ij} = c_k (d_{ij} \land d_{jk})$
      \item If $i \neq j$, then $c_i (d_{ij} \land a) \land c_i (d_{ij} \land - a) = 0$
    \end{itemize}
    ${\bf CA}_{\alpha}$ is the class of all cylindric algebras of dimension $\alpha$
    \item An $\alpha$-dimensional cylindric algebra $C$ is representable, if it is isomorphic to a generalised cylindric set algebra
    of dimension $\alpha$. Such is isomorphism is a representation of $C$.

    ${\bf RCA}_{\alpha}$ is the class of all representable cylindric algebras that have dimension $\alpha$. In particular, we are interested in the case when $\alpha = \omega$.
  \end{enumerate}
\end{defin}

It is well known that ${\bf RCA}_{\alpha}$ is a variety, ${\bf RCA}_{\alpha}$ ($\alpha \leq 2$) is finitely axiomatisable and ${\bf RCA}_{\alpha}$ ($2 < \alpha < \omega$) has no finite axiomatisation, see \cite{Henkin1988-HENCAP-4}.

Let $\mathcal{A} \in {\bf C}_{\omega}$, then $\mathcal{A}$ has a \emph{complete representation}, if this representation preserves all existing suprema.

Let us concretise the definition of a canonical extension for $\alpha$-dimensional cylindric algebras:

\begin{defin}
  Let $\mathcal{C} = \langle C, +, -, 0, 1, \{ d_{ij} \}_{i, j < \alpha}, \{c_i\}_{i < \omega} \rangle$ $\mathcal{A}$ be a BAO of type ${\bf CA}_{\alpha}$ Let ${\bf Uf}(\mathcal{C})$ be the set of all ultrafilters of $\mathfrak{B}\mathcal{C}$, the Boolean part of $\mathcal{C}$.

  Let us define ${\bf C}_{i} : {\bf Uf}(\mathcal{C}) \to {\bf Uf}(\mathcal{C})$ for each $i, j < \alpha$ as
  \begin{enumerate}
\item ${\bf C}_{i} \mathcal{X} = \{ \mathcal{F} \in {\bf Uf}(\mathcal{C}) \: | \: \exists \mathcal{F}' \in {\bf Uf}(\mathcal{C}) \: (a \in \mathcal{F} \Rightarrow c_i a \in \mathcal{F}' R)\}$,
\item $D_{ij} = \{ \mathcal{F} \in {\bf Uf}(\mathcal{C}) \: | \: d_{ij} \in \mathcal{F} \}$.
  \end{enumerate}
  The structure $\mathcal{C}^{+} = \langle  {\bf Uf}(\mathcal{C}), \cup, -, \emptyset, C, {\bf C}_{i < \alpha}, \{D_{ij}\}_{i, j < \alpha} \rangle$ is called the canonical extension of $\mathcal{C}$.
\end{defin}

Let us discuss the connection between representability and canonical extensions.

The following definitions and facts are due to Henkin, Monk, and Tarski \cite{henkin1971cylindric}.

Let $\mathcal{A} \in {\bf CA}_{\alpha}$ and $x \in \mathcal{A}$. Recall that \emph{the dimension of $x$}
is the set of all ordinals $\gamma < \alpha$ such that $c_\gamma x \neq x$. More formally,
\begin{center}
  $\Delta x = \{ \gamma \: | \: \gamma < \alpha \: \& \: c_\gamma x \neq x\}$
\end{center}

Let us discuss some metamathematical intuitions standing behind the notion of a dimension. Let $\Theta$ be a first-order theory and $\mathcal{C}/\equiv_{\Theta}$ its Lindenbaum-Tarski algebra. Let $\varphi$ be a formula in the signature of $\Theta$. Then $\Delta(\varphi/\Theta)$ consists of all $\kappa < \alpha$ such that $\exists x_{\kappa} \varphi \leftrightarrow \varphi$ is not valid in $\Theta$.
That is, $\Delta(\varphi/\Theta)$ contains ordinals $\kappa$ for which $x_{\kappa}$ is free in $\varphi$. Moreover, $\Delta(\varphi/\Theta)$ consists only of those ordinals for which $x_{\kappa}$ is free in every $\psi \in \varphi/\Theta$.

In particular, an element $x$ is called \emph{zero-dimensional} if $\Delta x = 0$. Zero-dimensional elements reflect equivalence classes of sentences in the Lindenbaum-Tarski algebra of a given first-order theory. Thus, the set of zero-dimensional elements form a Boolean algebras of sentences associated with $\Theta$.

\begin{defin}
  Let $\mathcal{A}$ be an $\alpha$-dimensional cylindric algebra. Let $\alpha$ be an ordinal and $\Gamma$ a subset $\alpha$, then an element $x \in \mathcal{A}$ is $\Gamma$-closed if $\Delta x \cdot \Gamma = \emptyset$. Alternatively, $x$ is a $\Gamma$-cylinder.

 $\operatorname{Cl}_{\Gamma}\mathcal{A}$ is the set of all $\Gamma$-closed elements.
\end{defin}

Metamathematically, $\Gamma$-closed elements reflect universal closures (is it correct?).

Let $\mathcal{C} = \langle C, +, -, 0, 1, \{d_{ij}\}_{i, j < \beta}, \{ c \}_{c < \beta} \rangle$ be a $\beta$-dimensional cylindic algebra and $\alpha \leq \beta$ an ordinal. The \emph{$\alpha$-th reduct} of $\mathcal{C}$, denoted as $\mathfrak{R}\mathfrak{d}_{\alpha}\mathcal{C}$, is an algebra having the form
\begin{center}
$\mathfrak{R}\mathfrak{d}_{\alpha}\mathcal{C} = \langle C, +, -, 0, 1, \{d_{ij}\}_{i, j < \alpha}, \{ c \}_{c < \alpha} \rangle$
\end{center}

$\mathcal{B}$ is a subreduct of $\mathcal{C}$, denoted as $\mathcal{B} \subseteq^{r} \mathcal{C}$, if $\mathcal{B} \subseteq \mathfrak{R}\mathfrak{d}_{\gamma}\mathcal{C}$ for some $\gamma \leq \beta$.

\begin{defin}
  Let $\mathcal{C}$ be a $\beta$-dimensional cylindic algebra and $\alpha$ an ordinal such that $\alpha \leq \beta$.
  The neat $\alpha$-reduct of $\mathcal{C}$, denoted as $\mathfrak{N}\mathfrak{r}_\alpha \mathcal{C}$,
  is the subalgbera $\mathcal{A}$ of $\mathfrak{R}\mathfrak{d}_{\alpha}\mathcal{C}$ with $\mathcal{A} = \operatorname{Cl}_{\kappa} \mathcal{C}$ where $\alpha + \kappa = \beta$.

  Let $\mathbb{K}$ be a class of $\beta$-dimensional cylindic algebras, then we put
  \begin{center}
    ${\bf Nr}_{\alpha}\mathbb{K} = \{ \mathfrak{N}\mathfrak{r}_\alpha \mathcal{C} \: | \: \mathcal{C} \in \mathbb{K} \}$
  \end{center}

  An algebra $\mathcal{B}$ is a neat subreduct of $\mathcal{C}$, or $\mathcal{B}$ is neatly embeddable to $\mathcal{C}$ if there exists an ordinal $\gamma \leq \alpha$ such that
  $\mathcal{C} \subseteq \mathfrak{R}\mathfrak{d}_{\gamma}\mathcal{B}$.
\end{defin}

One may define neat reducts alternatively as follows.
Let $\mathcal{C}$ be a $\beta$-dimensional cylindic algebra and $\alpha$ an ordinal such that $\alpha \leq \beta$. The neat $\alpha$-reduct of $\mathcal{C}$ is the $\alpha$-dimensional cylindric algebra having the form

\begin{center}
  $\mathfrak{N}\mathfrak{r}_\alpha \mathcal{C} = \langle \{ a \in \mathcal{C} \: | \: \forall j (\alpha \leq j \: \& \: j < \beta \Rightarrow c_j a = a) \}, +, -, 0, 1, \{d_{ij}\}_{i,j < \alpha}, \{c_{\gamma}\}_{\gamma} \rangle$
\end{center}

We will adapting the following proof of the fact that ${\bf RRA}$ is canonical \footnote{This idea is by Ian Hodkinson} to our case. This proof is due to Monk, but that was describe in McKenzie's thesis \cite{mckenzie1968representation}.

\begin{enumerate}
  \item A relation algebra $\mathcal{A}$ is representable iff $\mathcal{A}$ neatly embeds to some omege-dimensional cylinric algebra,
  \item If $\mathcal{A}$ neatly embeds in $\mathcal{A}$ then $\mathcal{A}^{+}$ neatly embeds in $\mathcal{B}^{+}$,
  \item ${\bf CA}_{\alpha}$ is closed under canonical extensions,
  \item Voil\'{a}.
\end{enumerate}

We descibe the following sketch of that proof published by Maddux in \cite{maddux2006relation}.

\begin{theorem}
  ${\bf RRA}$ is closed under canonical extensions.
\end{theorem}

\begin{proof}
\end{proof}

\begin{lemma}[Henkin, Monk, Tarski]\label{Neat}
  $ $

  Let $\mathcal{A}$ be a BAO of type ${\bf CA}_{\alpha}$ and $\mathcal{B}$ be a $\beta$-dimensional cylindric algebra such that $\beta \leq \alpha$ and $\mathcal{A}$ neatly embeds to $\mathcal{B}$ by a complete embedding. Then $\mathcal{A}^{+}$ neatly embeds to $\mathcal{B}^{+}$ by a complete embedding.
\end{lemma}

\begin{proof}
\end{proof}

\begin{theorem}[This assumption is by Ian Hodkinson]\label{Neat2}
  $ $

  Let $\mathcal{A}$ be a BAO of type ${\bf CA}_{\omega}$ such that $\mathcal{A}$ neatly embeds into ${\bf CA}_{\omega + \omega}$ by a complete embedding. Then $\mathcal{A}$ is completely representable as ${\bf CA}_{\omega}$.
\end{theorem}

\begin{proof}
  Hmmmmm, I believe so.
\end{proof}

Lemma~\ref{Neat} and Theorem~\ref{Neat2} imply the following theorem.

\begin{theorem}
  Let $\mathcal{C} \in {\bf RCA}_{\omega}$, then $\mathcal{C}^{+} \in {\bf RCA}_{\omega}$. That is, ${\bf RCA}_{\omega}$ is closed under canonical extensions.
\end{theorem}

\begin{proof}
  :monkahmm:
\end{proof}

\begin{comment}
\subsection{Substitution in cylindric algebras}

\begin{defin}
  Given a cylindric algebra of dimension $\alpha$ $C$, let $x$ be a term of its signature, the substitution operator $s^{i}_{j}$ have the following definition:
  \begin{center}
  $s^{i}_{j} x = \begin{cases} x, \text{if } i = j \\ c_i (d_{ij} \land x), \text{otherwise} \end{cases}$
  \end{center}
\end{defin}

\begin{prop} Let $\alpha$ be an ordinal and let $i, j, k, l < \alpha$. The following facts hold in ${\bf CA}_{\alpha}$

  \begin{enumerate}
    \item $s^{i}_j x \leq c_i x$.
    \item $s^{i}_j (x \land y) = s^{i}_j x \land s^{i}_j y$, $s^{i}_j (x \lor y) = s^{i}_j x \lor s^{i}_j y$, $- s^{i}_j x = s^{i}_j (- x)$.
    Moreover, $s^{i}_j$ is completely additive.
    \item $i \neq k, l$ implies $s^i_j d_{ik} = d_{jk}$ and $s^i_j d_{kl} = d_{kl}$.
    \item $d_{jk} \land s^{i}_j = d_{jk} \land s^{i}_k$.
    \item $s^i_j c_i x = c_i x$.
    \item $k \neq i,j$ implies $s^i_j c_i x = c_i s^i_j x$.
    \item $c_j s^i_j x = c_i s^j_i x$.
    \item $i \neq j$ implies $c_i s^i_j x = s^i_j x$.
    \item $i \neq k$ implies $s^i_j s^i_k = s^i_k x$.
    \item If either $i \notin \{ k, l\}$ and $k \notin \{ i, j\}$, or $j = l$, then $s^i_j s^k_l x = s^k_l s^i_j x$.
    \item $s^i_j s^j_i x = s^i_j x$.
    \item $s^i_k s^j_i x = s^i_k s^j_k x = s^j_k s^i_j x$
  \end{enumerate}
\end{prop}

\section{Model-theoretic and universal algebraic preliminaries}

\subsection{Ultraproducts}

Here are the required notions and facts from model theory and universal algebra \cite{hirsch2002relation} \cite{hodges1997shorter} \cite{sankappanavar1981course}.

Let $\Lambda$ be an index set and $D$ an ultrafilter on the Boolean algebra $\langle \mathcal{P}(\Lambda), \cup, -, \Lambda, \emptyset \rangle$. Consider the product $M = \prod \limits_{\lambda \in \Lambda} M_{\lambda}$ of the $\Omega$-structures $\{ M_{\lambda}\}_{\lambda \in \Lambda}$ and the equivalence relation on $\operatorname{dom}(M)$ defined as
\begin{center}
  $a_1 \sim a_2 \Leftrightarrow \{ \lambda \in \Lambda \: | \: a_1(\lambda) = a_2(\lambda)\} \in D$
\end{center}
Let us denote $\operatorname{dom}(M) / \sim$ as $U$ and $[a]_{\sim}$ as $a / D$, where $a \in \operatorname{dom}(M)$. We also denote the \emph{ultraproduct} of $\{ M_{\lambda} \}_{\lambda}$ as $\prod \limits_{\lambda \in \Lambda} M_{\lambda} / D$, or,
for brevity, as $\prod_{D} M_{\lambda}$. The $\Omega$-symbols have the following interpretation
\begin{enumerate}
  \item If $c \in \operatorname{Cnst}$, then $c^{U} = c^{M} / D$
  \item If $f \in \operatorname{Fn}$ is an $n$-ary function symbol and $\overline{a} \in M^{n}$, then $f^{U}(\overline{a}) = f^{M}(x) = f^{M}(\overline{a}) / D$
  \item If $R \in \operatorname{Fn}$ is an $n$-ary relation symbol and $\overline{a} \in M^{n}$, then $U \models R(\overline{a} / D)$ iff
  $\{ \lambda \in \Lambda \: | \: M_{\lambda} \models R(\overline{a} (\lambda))\} \in D$
\end{enumerate}
The ultraproduct is principal if $D$ is a principal filter.

\begin{defin}
$ $

  \begin{enumerate}
    \item Let $\{ M_{\lambda}\}_{\lambda \in \Lambda}$ be a set of $\Omega$-structures such that every
    $M_{\lambda}$ is isomorphic to the single structure $M$, then their ultraproduct over $D$ is called the ultrapower over $D$.
    The denotation is $\prod \limits_{D} M$ or $M^{\Lambda} / D$.
    \item If $\prod \limits_{D} M \cong N$ for some structure $N$, then $M$ is an ultraroot of $N$.
  \end{enumerate}
\end{defin}

\begin{theorem}[\L{}os]

  Let $\{ M_{\lambda}\}_{\lambda \in \Lambda}$ be $\Omega$-structures and $D$ an ultrafilter on $\Lambda$, and let
  $U = \prod \limits_{D} M_{\lambda}$ be an ultraproduct of $\{ M_{\lambda}\}_{\lambda \in \Lambda}$ over $D$. For each first-order formula
  $\varphi(x_1, \dots, x_n)$ and for each $a_1 / D, \dots, a_n / D \in U$:

\begin{center}
  $U \models \varphi(a_1 / D, \dots, a_n / D)$ iff $\{ \lambda \in \Lambda \: | \: \varphi(a_1(\lambda), \dots, a_n(\lambda))\} \in D$
\end{center}
\end{theorem}

The \L{}os has the following helpful corollary:

\begin{col}
  Let $\prod \limits_{D} M$ be an ultrapower of $M$. For $a \in M$, let us define a function $\overline{a} : a \mapsto a / D$.
  Then such a map is an elementary embedding of $M$ into $\prod \limits_{D} M$.
\end{col}

Moreover, any elementary equivalent structures have isomorphic ultrapowers.

Recall that a class of $\Omega$-structures ${\bf K}$ is called \emph{elementary}, if ${\bf K} = \operatorname{Mod}(\operatorname{T})$ for some first-order theory ${\bf T}$. In that case, $\operatorname{T}$ is an axiomatisation of ${\bf K}$.

\begin{theorem}
  Let ${\bf K}$ be a class $\Omega$-structures,
  ${\bf K}$ is elementary iff ${\bf K}$ is closed under isomorphic copies, ultraroots, and ultrapowers.
\end{theorem}


\section{${\bf IG}_{\omega}$ and ultraproducts}

\section{${\bf IG}_{\omega}$ is (not) (pseudo-)elementary; is (not) a variety}
\end{comment}

\bibliographystyle{plain}
\bibliography{Text}

\end{document}
