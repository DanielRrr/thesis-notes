\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bussproofs}
\usepackage{mathtools}
\usepackage{verbatim}
\usepackage{dsfont}
\usepackage{mathabx}
\usepackage[all, 2cell]{xy}
\usepackage[all]{xy}
\usepackage{wasysym}
\usepackage{rotating}
\usepackage{geometry}
\usepackage{trfsigns}
\usepackage{cmll}
\usepackage{authblk}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{lipsum}
\usepackage{extpfeil}
\usepackage{soul}
\usepackage{graphicx}

\newcommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}

\theoremstyle{defin}
\newtheorem{definition}{Definition}

\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}

\theoremstyle{claim}
\newtheorem{claim}{Claim}

\theoremstyle{prop}
\newtheorem{prop}{Proposition}

\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}

\theoremstyle{fact}
\newtheorem{fact}{Fact}

\theoremstyle{ex}
\newtheorem{ex}{Example}


\theoremstyle{col}
\newtheorem{col}{Corollary}

\let\strokeL\L
\DeclareRobustCommand{\L}{\ifmmode\mathbf{L}\else\strokeL\fi}

\author{Daniel Rogozin}
\date{}
\title{Characterising representable positive relation algebras with Priestley duality}

\begin{document}
\maketitle

\nocite{*}

\section{Distributive lattice representation and Priestley duality}

Given a bounded distributive lattice $\mathcal{L}$, a proper subset $F \subset \mathcal{L}$ is said to be a \emph{filter} if it is upward closed and closer under finite infima. A filter $F$ is \emph{prime} if $a + b \in F$ implies either $a \in F$ or $b \in F$. The spectrum of $\mathcal{L}$, denoted as $\operatorname{Spec}(\mathcal{L})$, is the set of all prime filters.

A filter is \emph{complete} if whenever $\Pi T$ exists for $T \subseteq F$, then $\Pi T \in F$. A filter is \emph{completely prime} if whenever $\Sigma T$ exists for $T \subseteq F$, then there exists $t \in T$ such that $t \in F$. The dual definitions are for ideals.

\begin{prop}
Let $h : \mathcal{L} \to \mathcal{R}$ be a representation, then then
\begin{center}
$h^{-1}[x] = \{ a \in \mathcal{L} \: | \: x \in h(a) \} \in \operatorname{Spec}(\mathcal{L})$
\end{center}
\end{prop}

Recall that a \emph{Priestley space} is a triple $\mathcal{X} = (X, \tau, \leq)$ such that $(X, \tau)$ is a compact topological space, $(X, \leq)$ is a bounded poset such that if $x \not\leq y$, then there exists a clopen $U$ such that $x \in U$ and $y \notin U$. Given a bounded distributive lattice $\mathcal{L}$, define the map $\phi : \mathcal{L} \to 2^{\operatorname{Spec}(\mathcal{L})}$ such that
\begin{center}
$\phi : a \mapsto \{ F \in \operatorname{Spec}(\mathcal{L}) \: | \: a \in F \}$
\end{center}

\begin{fact}

$ $

\begin{enumerate}
\item The sets $\phi(a)$ and $- \phi(a)$ form the subbasis of the topology $\tau$ on $\operatorname{Spec}(\mathcal{L})$.
\item $(\operatorname{Spec}(\mathcal{L}), \tau, \subseteq)$ is a Priestley space.
\end{enumerate}
\end{fact}

Given a Priestley space $\mathcal{X} = (X, \tau, \leq)$, the set $\operatorname{ClOp}(\mathcal{X})$ consists of all clopens of $\mathcal{X}$. The structure $(\operatorname{ClOp}(\mathcal{X}), \cap, \cup, \emptyset, X)$ is a distributive lattice.

\begin{fact} Let $\mathcal{L}$ be a distributive lattice and let $\mathcal{X}$ be a Priestley space:

\begin{enumerate}
\item $\mathcal{L} \hookrightarrow \mathcal{L}^{+} = (2^{\operatorname{Spec}(\mathcal{L})}, \cap, \cup, \emptyset, \operatorname{Spec}(\mathcal{L}))$,
\item $\mathcal{L} \cong \operatorname{ClOp}(\operatorname{Spec}(\mathcal{L}))$,
\item $\mathcal{X} \cong \operatorname{Spec}(\operatorname{ClOp}(\mathcal{X}))$,
\item The categories of Priestley spaces and bounded distributive lattices are dually equivalent.
\end{enumerate}
\end{fact}

\subsection{Completely representable distibutive lattices}

Let $\mathcal{L}$ be a bounded distributive lattice, then a set $S \subseteq 2^{\mathcal{L}}$ is said to be distinguishing if for every $a, b \in \mathcal{L}$ such that $a \neq b$ there exists $s \in S$ such that either $a \in s$ and $b \notin b$ or vice versa.

\begin{theorem} Let $\mathcal{L}$ be a bounded distributive lattice, then

\begin{enumerate}
\item $\mathcal{L}$ is completely representable iff $\mathcal{L}$ has a distinguishing set of complete, completely prime filters,
\item $(\mathcal{L}_+)^{+}$ is completely representable.
\end{enumerate}
\end{theorem}

TODO: read \cite{egrot2012completely}

\section{Representatiting positive relation algebras}

\begin{definition}

A positive relation algebra is a algebra $\mathcal{R} = (R, \cdot, +, ;, \smile, 0, 1, {\bf 1}')$ such that
\begin{enumerate}
\item $(R, \cdot, +, 0, 1)$ is a bounded distributive lattice,
\item $(R, ;, {\bf 1}')$ is a monoid,
\item for all $a, b, c \in R$
\begin{enumerate}
\item $a ; (b + c) = a ; b + a ; c$,
\item $a^{\smile \smile} = a$,
\item $(a + b)^{\smile} = a^{\smile} + b^{\smile}$,
\item $(a ; b)^{\smile} = b^{\smile} ; a^{\smile}$,
\item $(a ; b) \cdot c^{\smile} = 0 \leftrightarrow (b ; c) \cdot c^{\smile} = 0$.
\end{enumerate}
\end{enumerate}
\end{definition}

A positive relation algebra $\mathcal{R}$ is \emph{representable} if there exists a one-to-one function $h : \mathcal{R} \to 2^{X \times X}$ over the base set $X \neq \emptyset$ such that:
\begin{itemize}
\item $f(a \cdot b) = f(a) \cap f(b)$,
\item $f(a + b) = f(a) + f(b)$,
\item $f(0) = \emptyset$,
\item $f(1) = \bigcup \limits_{a \in \mathcal{R}} f(a)$,
\item $f({\bf 1}') = \Delta_X$,
\item $f(a ; b) = \{ (x, z) \: | \: \exists y \in X \: ((x, y) \in f(a) \: \& \: (y,z) \in f(b))\} = f(a) | f(b)$,
\item $f(a^{\smile}) = \{ (y, x) \: | \: (x, y) \in f(a) \}$.
\end{itemize}

A positive relation algebra is \emph{completely representable} if it is representable and its bounded distributive lattice reduct is completely representable.

\subsection{Priestley duality for positive relation algebras}

Given a positive relation algebra $\mathcal{R} = (R, \cdot, +, ;, \smile, {\bf 1}', 0, 1)$, let $A, B \subseteq \mathcal{R}$, define the usual pointwise product operation:
\begin{center}
$A ; B = \{ a ; b \: | \: a \in A, b \in B \}$
\end{center}
We modify this operation with the upward closure:
\begin{center}
$A \bullet B = \uparrow (A ; B)$
\end{center}

We use the $\bullet$ operation to analyse the following properties of filters in positive relation algebras:
\begin{fact} Let $\mathcal{R}$ be a positive relation algebra, then

\begin{enumerate}
\item If $F \subseteq \mathcal{R}$ is a filter, then for each $X, Y \subseteq \mathcal{R}$ $X ; Y \subseteq F$ iff $X \bullet Y \subseteq F$
\item If $F_1, F_2 \subseteq \mathcal{R}$ are filters, so is $F_1 \bullet F_2$,
\item Let $F_1, F_2$ be filters and $F_3 \in \operatorname{Spec}(\mathcal{R})$ such that $F_1 \bullet F_2 \subseteq F_3$, then there are $F_1', F_2' \in \operatorname{Spec}(\mathcal{R})$ such that $F_1 \subseteq F_1'$, $F_2 \subseteq F_2'$ and $F_1' \bullet F_2' \subseteq F_3$.
\end{enumerate}
\end{fact}

First of all, given a positive relation algebra $\mathcal{R} = (R, \cdot, +, ;, \smile, 0, 1, {\bf 1}')$, we define its canonical extension $\mathcal{R}^{+}$ on the subsets of the spectrum $\operatorname{Spec}(\mathcal{R})$ by piggybacking Priestley representation of bounded distibutive lattices.

TODO:


A PRA-space is a structure $(X, \tau, \leq, R, I, E)$ where $X = (X, \tau, \leq)$ is a Priestley space and $R \subseteq X^3$, $I \subseteq X^2$ and $E \subseteq X$ such that:
\begin{enumerate}
\item For all $x, y, z \in X$ such that $R(x, y, z)$:
\begin{itemize}
\item $x \geq x'$ for $x' \in X$ implies $R(x', y, z)$,
\item $y \leq y'$ for $y' \in X$ implies $R(x, y', z)$,
\item $z \leq z'$ for $z' \in X$ implies $R(x, y, z')$.
\end{itemize}
\item For all $x, y, z, w \in X$ there exists $u \in X$ such that $R(x, y, u)$ and $R(u, z, w)$ iff there exists $v \in X$ such that $R(y,z,v)$ and $R(x, v, w)$,
\item If $A, B \subseteq X$ are upward closed, so is $R[A, B, \underline{\:\:\:}]$,
\item $I(A)$ is upward closed clopen whenever $A$ is upward closed clopen,
\item $I(x)$ is closed for each $x \in X$,
\item For all $x, y, z \in X$, $x \leq y$ and $I(x, z)$ imply $I(y, z)$,
\item For all $x, y \in X$ there exists $z \in X$ such that $x = y$ iff $I(z, y)$ and $I(x, z)$,
\item For all $x, y, z \in X$ there exists $u \in X$ such that $I(u, z)$ and $R(x, y, u)$ iff there exist $u, w \in X$ such that $R(v, w, z)$, $I(y,v)$ and $I(x, w)$.
\item For all $x,y,u, v \in X$, $R(u,v,y)$ and $I(x, u)$ implies $R(x,y,v)$,
\item $E$ is upward closed clopen such that for each clopen $A \subseteq X$ one has
\begin{center}
$R[A, E, \overline{\:\:\:}] = R[E, A, \overline{\:\:\:}] = A$
\end{center}
\end{enumerate}

\begin{theorem} Let $\mathcal{R}$ be a positive relation algebra and $\mathcal{X}$ a PRA-space, then

\begin{enumerate}
\item $\mathcal{R} \hookrightarrow \mathcal{R}^{+} = (2^{\operatorname{Spec}(R)}, \cup, \cap, \emptyset, \operatorname{Spec}(R), \bullet, \iota, \epsilon)$,
\item $\mathcal{R} \cong \operatorname{ClOp}(\operatorname{Spec}(\mathcal{R}))$,
\item $\mathcal{X} \cong \operatorname{Spec}(\operatorname{ClOp}(\mathcal{X}))$,
\item The categories of positive relation algebras and PRA-spaces are dually equivalent.
\end{enumerate}

\begin{proof} $ $

\begin{enumerate}
\item We check only the cases of $\bullet$, $\iota$ and $\epsilon$.
\item Note that the dual space of a positive relation algebra $\mathcal{R}$ is a PRA-space.

TODO: check the claim above

\item The dual space of a PRA-space is a positive relation algebra.

TODO: check the claim above

\item
\end{enumerate}
\end{proof}

\end{theorem}



\section{The main result}

For that we need such model theoretic notions as saturation and types, see \cite[Section 6.3]{hodges1993model}.

\begin{definition} Let $\mathcal{M}$ be a first-order structure of a signature $L$ and $S \subseteq \mathcal{M}$. Let $L(S)$ be an extension of $L$ with copies of elements from $S$ as additional constants. We assume that $Cnst(L)$ and $S$ are disjoint.

\begin{enumerate}
\item Let $n < \omega$, an $n$-type over $S$ is a set $\mathcal{T}$ of $L(S)$ formulas $A(\overline{x})$, where $\overline{x}$ is a fixed $n$-tuple of elements from $S$. Notation: $\mathcal{T}(\overline{x})$. A type is an $n$-type for some $n < \omega$.
\item An $n$-type $\mathcal{T}(\overline{x})$ is realised in $\mathcal{M}$, if there exists $\overline{m} \in \mathcal{M}^n$ such that $\mathcal{M} \models A(\overline{m})$ for every $A \in \mathcal{T}(\overline{x})$. $\mathcal{M}$ omits $\mathcal{T}(\overline{x})$, if $\mathcal{T}(\overline{x})$ is not realised in $\mathcal{M}$.
\item $\mathcal{T}(\overline{x})$ is finitely satisfied in $\mathcal{M}$, if every finite subtype $\mathcal{T}_0(\overline{x}) \subseteq \mathcal{T}(\overline{x})$ is realised in $\mathcal{M}$. We can reformulate that as $\mathcal{M} \models \exists \overline{a} \bigwedge \limits_{A \in \mathcal{T}_0} A(\overline{a})$.
\item Let $T$ be a theory, then a type $\mathcal{T}$ over the empty set of constants is $T$-consistent, if there exists a model $\mathcal{M} \models T$ such that $\mathcal{T}$ is finitely satisfied in $\mathcal{M}$.
\item Let $\kappa$ be a cardinal, then $\mathcal{M}$ is $\kappa$-saturated, if for every $S \subseteq \mathcal{M}$ with $|S| < \kappa$ every finitely satisfied $1$-type $\mathcal{T}$ is realised in $\mathcal{M}$.
\end{enumerate}
\end{definition}

By default, a saturated model is an $\omega$-saturated model for us.

The useful facts, they are from \cite{chang1990model} and \cite{hodges1993model}:

\begin{fact} Let $\mathcal{M}$ be an FO-structue and $\kappa$ a cardinal, then:
\begin{enumerate}
\item $\mathcal{M}$ is $\kappa$-saturated iff every finitely satisfiable $\alpha$-type (an arbitrary $\alpha \leq \kappa$) with fewer than $\kappa$ parameters is realised in  $\mathcal{M}$.
\item If $\mathcal{M}$ is $\kappa$-saturated, then $\mathcal{M}$ is $\lambda$-saturated for every $\lambda < \kappa$.
\item \label{saturation} Every consistent theory has a $\kappa$-saturated model and every model has an elementary $\kappa$-saturated extension.
\item Let $(\mathcal{M}_i)_{i < \omega}$ a family of structures of the (at most) countable signature and $D$ a non-principal ultrafilter over $\omega$, then $\Pi_D \mathcal{M}_i$ is $\omega_1$-saturated.
\end{enumerate}
\end{fact}

Let $\mathcal{A}$ be a positive relation algebra, define the first-order relational language of the form
\begin{center}
$\mathcal{L}(\mathcal{A}) = (=, \{ R^2_a \}_{a \in \mathcal{A}})$
\end{center}

The $\mathcal{L}(\mathcal{A})$-theory ${T}_{\mathcal{A}}$ consists of the following statements:
\begin{itemize}
\item $\sigma_1 = \forall x \forall y ({\bf 1}'(x, y) \leftrightarrow (x = y))$
\item $\sigma_+(R, S, T) = \forall x \forall y (R(x, y) \leftrightarrow S(x, y) \lor T (x, y))$
\item $\sigma_{\cdot}(R, S, T) = \forall x \forall y (R(x, y) \leftrightarrow S(x, y) \land T (x, y))$
\item $\sigma_{;}(R, S, T) = \forall x \forall y (R(x, y) \leftrightarrow \exists z (S(x, z) \land T(z, y)))$
\item $\sigma_{\smile}(R, S) = \forall x \forall y (R(x, y) \leftrightarrow S(y, x))$
\item $\sigma_{\neq 0} = \exists x \exists y R(x, y)$ for any $R_a$ such that $a \neq 0$
\item $\sigma_{0} = \neg \exists x \exists y 0(x, y)$
\item $\sigma_{{\bf 1}} = \forall x \forall y (R(x, y) \rightarrow {\bf 1}(x, y))$
\end{itemize}

\begin{prop}
$T_{\mathcal{A}}$ is satisfiable whenever $\mathcal{A}$ is representable.
\end{prop}

\begin{theorem}
Let $\mathcal{A}$ be a positive relation algebra, then $\mathcal{R}$ is representable iff $\mathcal{R}^{+}$ is completely representable.
\end{theorem}

\begin{proof}
The right-to-left implication is easy. If $\mathcal{R}^{+}$ is representable (no completeness needed here), so is $\operatorname{ClOp}(\operatorname{Spec}(\mathcal{L}))$ as a subalgebra of $\mathcal{R}^{+}$. But, by Priestley duality for positive relation algebras, $\operatorname{ClOp}(\operatorname{Spec}(\mathcal{L})) \cong \mathcal{L}$, so $\mathcal{L}$ is representable.

Assume that $\mathcal{R}$ is representable, then $T_{\mathcal{R}}$ is satisfiable, let $M \models T_{\mathcal{R}}$ and $M$ is $\omega$-saturated. Define a map $h : \mathcal{R}^+ \to 2^{M \times M}$ as
\begin{center}
$h : F \mapsto \{ (x, y) \in 1^M \: | \: f_{x, y} \in F \}$
\end{center}
where
\begin{center}
$f_{x, y} = \{ a \in \mathcal{R} \: | \: M \models R_a(x,y) \}$
\end{center}

\begin{claim}
$f_{x, y} \in \operatorname{Spec}(\mathcal{R})$ whenever $M \models 1(x, y)$.
\end{claim}

\begin{proof}
Let $a \in f_{x, y}$ and $a \leq b$.

Then $M \models R_a(x, y)$. But $a \leq b$ iff $a \cdot b = a$, so, from the axiom $R_{\cdot}(R_a, R_a, R_b)$ we have $M \models R_b(x, y)$.

Let $a, b \in f_{x, y}$, so $M \models R_a(x, y) \land R_b(x, y)$, so $R_{a \cdot b}(x, y)$ by the axiom $R_{\cdot}(R_a, R_a, R_b)$ again.

Let $a + b \in f_{x, y}$, so $M \models R_{a + b}(x, y)$, then we have either $M \models R_a(x, y)$ or $M \models R_b(x, y)$, so either $a \in f_{x,y}$ or $b \in f_{x,y}$.
\end{proof}

\begin{claim}
$h$ is one-to-one.
\end{claim}

\begin{claim}
$h$ is a complete representation of the bounded lattice reduct.
\end{claim}

\begin{proof}
Follows from the fact that $\operatorname{Spec}(\mathcal{L})$ is a Hausdorff space. (????)
\end{proof}

\begin{claim}
$h$ preserves the structure of an involutive monoid.
\end{claim}
\end{proof}

\begin{theorem}
${\bf RPRA}$ is a canonical variety. (is it a variety at all?)
\end{theorem}

\section{Union-free reducts of positive relation algebras}

TODO: \cite{bezhanishvili2011priestley}.

\bibliographystyle{alpha}
\bibliography{Text}
\end{document}
