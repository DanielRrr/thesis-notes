\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bussproofs}
\usepackage{mathtools}
\usepackage{verbatim}
\usepackage{dsfont}
\usepackage{mathabx}
\usepackage[all, 2cell]{xy}
\usepackage[all]{xy}
\usepackage{wasysym}
\usepackage{rotating}
\usepackage{geometry}
\usepackage{trfsigns}
\usepackage{cmll}
\usepackage{authblk}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{lipsum}
\usepackage{extpfeil}
\usepackage{soul}
\usepackage{graphicx}

\newcommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}

\theoremstyle{defin}
\newtheorem{definition}{Definition}

\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}

\theoremstyle{claim}
\newtheorem{claim}{Claim}

\theoremstyle{prop}
\newtheorem{prop}{Proposition}

\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}

\theoremstyle{fact}
\newtheorem{fact}{Fact}

\theoremstyle{ex}
\newtheorem{ex}{Example}


\theoremstyle{col}
\newtheorem{col}{Corollary}

\let\strokeL\L
\DeclareRobustCommand{\L}{\ifmmode\mathbf{L}\else\strokeL\fi}

\author{Daniel Rogozin}
\date{}
\title{Finite model property for residuated semigroups and related remarks}

\begin{document}
\maketitle

\nocite{*}

\section{Finite networks for atomic formulas}

Let $PV = \{ p_i \: | \: i < \omega \}$ be the set of propositional variables (or atomic types).
The set of formulas is generated by the following grammar:
\begin{center}
$\varphi, \psi ::= p \: | \: (\varphi \bullet \psi) \: | \: (\varphi \backslash \psi) \: | \: (\varphi / \psi)$
\end{center}

The Lambek calculus is defined as a Gentzen-style sequent calculus:

\begin{prooftree}
\AxiomC{$ $}
\RightLabel{\scriptsize{ax}}
\UnaryInfC{$p \rightarrow p$}
\end{prooftree}

\begin{minipage}{0.5\textwidth}
\begin{flushleft}
      \begin{prooftree}
    \AxiomC{$\Gamma \rightarrow \varphi$}
    \AxiomC{$\Delta, \psi, \Theta \rightarrow \theta$}
    \RightLabel{$\backslash \rightarrow$}
    \BinaryInfC{$\Delta, \Gamma, \varphi \backslash \psi, \Theta \rightarrow \theta$}
  \end{prooftree}

  \begin{prooftree}
    \AxiomC{$\Gamma \rightarrow \varphi$}
    \AxiomC{$\Delta, \psi, \Theta \rightarrow \theta$}
    \RightLabel{$/ \rightarrow$}
    \BinaryInfC{$\Delta, \psi / \varphi, \Gamma, \Theta \rightarrow \theta$}
  \end{prooftree}

  \begin{prooftree}
    \AxiomC{$\Gamma, \varphi, \psi, \Delta \rightarrow \theta$}
    \RightLabel{$\bullet \rightarrow$}
    \UnaryInfC{$\Gamma, \varphi \bullet \psi, \Delta \rightarrow \theta$}
  \end{prooftree}
\end{flushleft}
\end{minipage}\hfill
\begin{minipage}{0.5\textwidth}
\begin{flushright}
  \begin{prooftree}
    \AxiomC{$\varphi, \Pi \rightarrow \psi$}
    \RightLabel{$\rightarrow \backslash, \Pi \text{ is non-empty}$}
    \UnaryInfC{$\Pi \rightarrow \varphi \backslash \psi$}
  \end{prooftree}

  \begin{prooftree}
    \AxiomC{$\Pi, \varphi \rightarrow \psi$}
    \RightLabel{$\rightarrow /, \Pi \text{ is non-empty}$}
    \UnaryInfC{$\Pi \rightarrow \psi / \varphi$}
  \end{prooftree}

  \begin{prooftree}
    \AxiomC{$\Gamma \rightarrow \varphi$}
    \AxiomC{$\Delta \rightarrow \varphi$}
    \RightLabel{$\rightarrow \bullet$}
    \BinaryInfC{$\Gamma, \Delta \rightarrow \varphi \bullet \psi$}
  \end{prooftree}
\end{flushright}
\end{minipage}

\subsection{Completeness}

\begin{theorem}
Let $RS$ be the class of all residuated semigroups, then $\Gamma \rightarrow \varphi$ iff $RS \models \Gamma \rightarrow \varphi$
\end{theorem}

\section{Representability networks for at most countable residuated semigroups}

\subsection{Relational residuated semigroups as Kripke models}

One can introduce Kripke-style relational semantics for the Lambek calculus as follows. Let $W$ be a non-empty set and $R$ a transitive relation on $W$. We consider models of the kind $M = (R, \vartheta)$, where $\vartheta : PV \to 2^R$. The truth definition is inductive:
\begin{itemize}
\item $\mathcal{M}, (x,y) \models p_i$ iff $(x, y) \in \vartheta(p_i)$,
\item $\mathcal{M}, (x,y) \models \varphi \bullet \psi$ iff there exists $z \in W$ such that
$(x,z), (z, y) \in R$ and $\mathcal{M}, (x, z) \models \varphi$ and $\mathcal{M}, (z, y) \models \phi$
\item $\mathcal{M}, (x, y) \models \varphi \setminus \psi$ iff for all $z \in W$ such that if $(z, x) \in R$ and $\mathcal{M}, (z, x) \models \varphi$, then $\mathcal{M}, (z, y) \models \psi$
\item $\mathcal{M}, (x, y) \models \varphi / \psi$ iff for all $z \in W$ such that if $(y, z) \in R$ and $\mathcal{M}, (y, z) \models \psi$, then $\mathcal{M}, (x, z) \models \varphi$
\item $\mathcal{M}, (x, y) \models \varphi_1, \varphi_2, \dots, \varphi_n \rightarrow \varphi$ iff $\mathcal{M}, (x, y) \models \varphi_1 \bullet \varphi_2 \bullet \dots \bullet \varphi_n$ implies $\mathcal{M}, (x, y) \models \varphi$.
\end{itemize}

According to the definition above, to refute a sequent $\varphi_1, \varphi_2, \dots, \varphi_n \rightarrow \varphi$, we have to find a transitive binary relation $R$, some valuation $\vartheta : PV \to 2^R$ and $(x, y) \in R$ such that
$\mathcal{M}, (x, y) \models \varphi_1 \bullet \varphi_2 \bullet \dots \bullet \varphi_n$, but $\mathcal{M}, (x, y) \nvDash \varphi$. Alternatively, one can reformulate that condition as
\begin{center}
$(x, y) \in ||\varphi_1|| ; ||\varphi_2|| ; \dots ; ||\varphi_n||$, but $(x, y) \notin ||(x, y)||$
\end{center}

\subsection{Relational representation of residuated semigroups: a game-theoretic approach}

Let $\mathcal{A}$ be a residuated semigroup, an $\mathcal{A}$-prenetwork is a triple $\mathcal{N} = (V, E, l)$, where where $(V, E)$ is a directed graph and $l : E \to \mathcal{A}$ is a labelling function. A prenetwork is a network if
the following conditions hold:
\begin{itemize}
\item $E$ has no loops and it is transitive,
\item $l(x, z) \leq l(x, y) ; l(y,z)$, whenever $(x, y), (y, z) \in E$, for all $x, y, z \in V$,
\item For all $a \in \mathcal{A}$, for all $x \in U$, there is some $u \in U$ such that $l(u, x) = a$,
\item For all $a \in \mathcal{A}$, for all $y \in U$, there is some $v \in U$ such that $l(y, v) = a$,
\item For all $a, b, c \in \mathcal{A}$, for all $x, y \in U$, if $c \leq a ; b$, $(x, y) \in E$ and $l(x, y) = c$, then there exists $z \in U$ such that $l(x,y) = a$ and $l(y, z) = b$.
\end{itemize}

Let $n \leq \omega$, define a game $\mathcal{G}(\mathcal{A})_n$ for two players $\forall$ and $\exists$ by induction on $n$.
\begin{enumerate}
\item {\bf step} 0

$\forall$ picks a pair of elements $a, b \in \mathcal{A}$ such that $a \not\leq b$. $\exists$ must respond with a network $\mathcal{N}_0 = (\{ x, y\}, \{(x,y)\}, l_0 : (x,y) \mapsto a)$:

\xymatrix{
&&&&&& x \ar[rr]^{a} && y
}

\item {\bf step} $n + 1 < \omega$

Suppose the networks:
\begin{center}
$\mathcal{N}_0 \subseteq \mathcal{N}_1 \subseteq \dots \subseteq \mathcal{N}_n$
\end{center}
have been already constructed.

There are four different options:
\begin{enumerate}
\item {\bf Composition move}

$\forall$ picks $x, y, z \in \mathcal{N}_n$ such that $b = l_n(x, y)$ and $c = l_n(y, z)$:

\xymatrix{
&&&&&&& y \ar[dr]^{c} \\
&&&&&& x \ar[ur]^{b} && z
}

$\exists$ has to respond with $\mathcal{N}_{n + 1} = (V_n, E_n \cup \{ (x,z)\}, l_{n+1})$ where $l_{n+1}(x,z) = b ; c$ and $l_{n+1}(x',y') = l_n(x',y')$ for $(x', y') \in E_n$.

\xymatrix{
&&&&&&& y \ar[dr]^{c} \\
&&&&&& x \ar@{-->}[rr]_{b ; c} \ar[ur]^{b} && z
}

\item {\bf Witness move}
$\forall$ picks $(x,y) \in E_n$ such that $l_n(x,y) = a$ and $a \leq b ; c$:

\xymatrix{
&&&&&& x \ar[rr]^{a} && y
}

$\exists$ has to respond with $\mathcal{N}_{n + 1} = (V_n \cup \{ z \}, E_n \cup \{ (x,z), (z, y) \}, l_{n + 1})$, where
\begin{center}
$l_{n + 1}(x, z) = b$

$l_{n + 1}(y, z) = c$

$l_{n + 1}(p) = l_n$ for others $p \in E_n$
\end{center}

The latter can be visualised with the following triangle:

\xymatrix{
&&&&&& x \ar[rr]^{a} \ar@{-->}[dr]_{b} && y \\
&&&&&&& z \ar@{-->}[ur]_{c}
}


\item {\bf Left redisual move}



\item {\bf Right residual move}



\end{enumerate}
\end{enumerate}

\begin{theorem}

Let $\mathcal{A}$ be a at most countable residuated semigroup, then

\begin{enumerate}
\item $\exists$ has a winning stragery in $\mathcal{G}_{\omega}(\mathcal{A})$

\begin{center}
$rep(a) = \{ (x,y) \: | \: l(x, y) \leq a \}$
\end{center}

\begin{enumerate}
\item $rep(a ; b) = rep(a) ; rep(b)$
\item $rep(a \setminus b) = rep(a) \setminus rep(b)$
\item $rep(a / b) = rep(a) / rep(b)$
\end{enumerate}

\item $\mathcal{A}$ is representable.
\end{enumerate}
\end{theorem}

TODO: check if the representability class is closed under products, subalgebras and ultraproducts. Check the criterion for the Horn formulas. Closed under H? can't be defined by equations?

\section{Step-by-step construction for the FMP}

\subsection{Example 1}

Consider a sequent $\varphi_1 \bullet \varphi_2 \rightarrow \varphi_1 \bullet (\psi_1 \setminus \psi_2)$, which is known to unprovable in the Lambek calculus. We would like to construct a finite model on a network such that there exists $(u, v) \nvDash \varphi_1 \bullet \varphi_2 \rightarrow \varphi_1 \bullet (\psi_1 \setminus \psi_2)$, that is, $(u, v) \in ||\varphi_1|| ; ||\varphi_2||$ and $(u, v) \notin ||\varphi_1|| ; (||\psi_1|| \setminus ||\psi_2||)$.

The construction is step-by-step:
\begin{enumerate}
\item {\bf Step 0}

We construct the edge $(u, v)$ labelled by a pair of sets $\lambda_0$ and $\delta_0$:

\centerline{
\xymatrix{
u \ar[rr]^{\lambda_0}_{\delta_0} && v
}
}

\begin{center}
$\lambda_{0}(u, v) = \{ \varphi_1 \bullet \varphi_2, -(\varphi_1 \bullet (\psi_1 \setminus \psi_2)) \}$

$\delta_{0}(u, v) = \{ \varphi_1 \bullet \varphi_2\}$
\end{center}

\item {\bf Step 1}

We have to create a witness for $\varphi_1 \bullet \varphi_2 \in \delta_{0}(u, v)$ by adding a vertice $w$:

\centerline{
\xymatrix{
& w \ar[ddr]^{\lambda_1}_{\delta_1} \\
\\
u \ar[uur]^{\lambda_1}_{\delta_1}
\ar[rr]^{\lambda_0}_{\delta_0} && v
}
}

\begin{center}
$\lambda_1(u, w) = \{ \varphi_1 \}$

$\lambda_1(w, v) = \{ \varphi_2, -(\psi_1 \setminus \psi_2)\}$

$\delta_1(u, w) = \emptyset$

$\delta_1(w, v) = \{ - (\psi_1 \setminus \psi_2) \}$
\end{center}

\item {\bf Step 2}

We create a witness $w'$ for $- (\psi_1 \setminus \psi_2) \in \delta_1(w, v)$

\centerline{
\xymatrix{
w \ar[ddrr]^{\lambda_1}_{\delta_1} && w' \ar[ll]_{\lambda_2}^{\delta_2} \ar[dd]_{\lambda_2}^{\delta_2} \\
\\
u \ar[uu]^{\lambda_1}_{\delta_1}
\ar[rr]^{\lambda_0}_{\delta_0} && v
}
}

By putting:
\begin{center}
$\lambda_2(w', w) = \{ \psi_1 \}$

$\lambda_2(w', v) = \{ -\psi_2 \}$

$\delta_2(w', w) = \emptyset$

$\delta_2(w', v) = \emptyset$
\end{center}

\end{enumerate}

Now let us describe $||\varphi_1|| ; ||\varphi_2||$ as follows:

TODO:

\subsection{Example 2}

Let us consider a sequent $LC \not\vdash \varphi_1 \setminus (\varphi_2 \bullet \varphi_3) \rightarrow \varphi_1 \setminus \psi$

\begin{enumerate}
\item {\bf Step 0}

Introduce a wedge $(u, v)$ with labelling $\lambda_0$ and $\delta_0$

\centerline{
\xymatrix{
u \ar[rr]^{\lambda_0}_{\delta_0} && v
}
}

where

\begin{center}
$\lambda_0(u, v) = \{\varphi_1 \setminus (\varphi_2 \bullet \varphi_3), -(\varphi_1 \setminus \psi)\}$

$\delta_0(u, v) = \{ -(\varphi_1 \setminus \psi) \}$
\end{center}

\item {\bf Step 1}

We create a witness $w$ for $-(\varphi_1 \setminus \psi) \in \delta_0(u, v)$

\centerline{
\xymatrix{
& w \ar[ddr]^{\lambda_1}_{\delta_1} \ar[ddl]_{\lambda_1}^{\delta_1} \\
\\
u \ar[rr]^{\lambda_0}_{\delta_0} && v
}
}
where
\begin{center}
$\lambda_1(w, u) = \{ \varphi_1 \}$

$\lambda_1(w, v) = \{ -\psi, \varphi_1 \bullet (\varphi_1 \setminus (\varphi_2 \bullet \varphi_3)), \varphi_2 \bullet \varphi_3\}$

$\delta_1(w, u) = \emptyset$

$\delta_1(w, v) = \{ \varphi_2 \bullet \varphi_3 \}$

\end{center}

\item {\bf Step 2}

We have to create a witness $w'$ for $\varphi_2 \bullet \varphi_3 \in \delta_1(w, v)$

\centerline{
\xymatrix{
w \ar[ddrr]^{\lambda_1}_{\delta_1} \ar[dd]_{\lambda_1}^{\delta_1} \ar[rr]^{\lambda_2}_{\delta_2} && w' \ar[dd]_{\lambda_2}^{\delta_2} \\
\\
u \ar[rr]^{\lambda_0}_{\delta_0} && v
}
}

\begin{center}
$\lambda_2(w, w') = \{ \varphi_2 \}$

$\lambda_2(w', v) = \{ \varphi_3 \}$

$\delta_2(w, w') = \emptyset$

$\delta_2(w', v) = \emptyset$
\end{center}

\end{enumerate}

\subsection{General case}

Consider a sequent $\Gamma \rightarrow \varphi$ such that $LC \not\vdash \Gamma \rightarrow \varphi$. We have to construct a finite relational model over some network such that $(u, v) \not\models \Gamma \rightarrow \varphi$, that is, $(u, v) \models \Gamma$ and $(u, v) \not\models \varphi$.

\bibliographystyle{alpha}
\bibliography{Text}
\end{document}
